<!--
// ###############################################################################
// #
// # APTUS FonB is Copyright (c) 2013 by APTUS, Inc.
// # All rights reserved.
// #
// # APTUS FonB is confidential to APTUS and protected by Copyright and
// # other bodies of law protecting intellectual property rights.
// #
// # Redistribution, reproduction and use in source and binary forms, with or without
// # modification, are NOT permitted.
// #
// # A non­exclusive and
// # non-transferable license for the internal evaluation and production use of
// # this product is available from APTUS.
// #
// # Unless enforcement is prohibited by applicable law, you may not modify,
// # decompile, or reverse engineer APTUS FonB. No right, title or interest
// # in or to any trademark, service mark, logo or trade name of APTUS or its
// # licensors is granted.
// #
// # APTUS FONB IS PROVIDED "AS IS," WITHOUT WARRANTY. ALL WARRANTIES,
// # EXPRESS OR IMPLIED, CONDITIONS, AND REPRESENTATIONS, INCLUDING ANY IMPLIED
// # WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE OR
// # NON­INFRINGEMENT ARE DISCLAIMED
// #
// ###############################################################################
-->
<!-- BEGIN: main -->
<div id="addcontactpage" style="width:500px;">
<form action="index.php?module=addcontact" autocomplete="off" class="new subject" id="new_person" method="post">
<div class="contactplace" style="width:100%;">
        <table cellpadding="0" cellspacing="0" class="contact_types" style="width:100%;">
         <tr>
            <td style="width:50%;text-align:center;font-weight:bold;background-color:#004e6b;padding-top:10px;color:#fff;"><img style="padding-right:8px;" src="images/qd_personal.png"/>{{t "Personal contacts"}}</td>
            <td style="width:50%;text-align:center;font-weight:bold;background-color:#006b51;padding-top:10px;color:#fff;"><img style="padding-right:8px;" src="images/qd_crm.png"/>{{t "Highrise contacts"}}</td>
         </tr>
        </table cellpadding="0" cellspacing="0" class="contact_types">
</div class="contactplace" style="width:100%;">
<!-- BEGIN: personcontacts -->
<div class="{vcfsource}contacts" style="">
<div class="page_divider" style="background-color:#f0fff8">
      <div class="primary_fields">
        <table cellpadding="0" cellspacing="0" class="contact_types">
          <tr>
            <th></th>
            <td></td>
          </tr>
          <tr class="name first_name">
            <th><h2>{{t "First name"}}</h2></th>
            <td><input class="name autofocus" id="person_first_name" name="person[first_name]" size="30" type="text" value="{personfirstname}"/></td>
          </tr>
          <tr class="name last_name">
            <th><h2>{{t "Last name "}}</h2></th>
            <td><input class="name autofocus" id="person_last_name" name="person[last_name]" size="30" type="text" value="{personlastname}"/></td>
          </tr>
<!-- BEGIN: title -->
          <tr class="title" id="title_field_person">
            <th><h2>{{t "Title"}}</h2></th>
            <td>
              <div class="contact_forms" id="title_person">
                <div class="blank_slate">{{t "Add a title"}}</div>
                <div class="contact_methods" style='display:none;'>
                  <div class="contact_method">
                    <input class="autofocus" id="person_title" name="person[title]" size="30" type="text"  value="{persontitle}"/>
                  </div>
                </div>
              </div>
             </td>
          </tr>
<!-- END: title -->
          <tr class="company last">
            <th><h2>{{t "Company"}}</h2></th>
            <td>
              <div class="contact_forms" id="company_person">
                <div class="blank_slate">{{t "Add a company"}}</div>
                <div class="contact_methods" style='display:none;'>
                  <div class="contact_method" style="position:relative;">
                    <input id="person_company_name" name="person[company_name]" size="30" type="text" value="{personcompany}"/><br/>
                  </div>
                  <script type="text/javascript"></script>
                </div>
              </div>
            </td>
          </tr>
        </table cellpadding="0" cellspacing="0" class="contact_types">
      </div class="primary_fields">
</div class="page_divider">
<div class="secondary_fields" style="padding:10px;padding-left:30px;">
      <table class="contact_types" cellpadding="0" cellspacing="0" id="contact_section">
        
<!-- BEGIN: telephone -->
          <tr>
  <th><h2>{{t "Phone"}}</h2></th>
  <td><div class="contact_forms phone_numbers" id="phone_number_list_person"><div id="blank_slate_person_phone_number" class='blank_slate'>{{t "Add a phone number"}}</div>
<div class="contact_methods" style="display:none;">
<!-- BEGIN: telephones -->
  <div class="contact_method new_contact_method edit_phone">
    <input class="autofocus" id="person_contact_data_phone_numbers__number" name="person[contact_data][phone_numbers][][number]" size="30" type="text" value="{personphonenum}" />
	<span class="overlay_wrapper">
    <label for="person_contact_data_phone_numbers__location" class="overlabel">{{t "Mobile"}}</label>
    <input id="person_contact_data_phone_numbers__location" class="person_contact_input_type" name="person[contact_data][phone_numbers][][location]" type="text" value="{personphonetype}" style="padding-left:2px;margin-left:4px;" />
	</span>
    <span class="addremove"><a href="#" class="remove">{{t "Remove"}}</a></span>
  </div class="contact_method new_contact_method edit_phone">
<!-- END: telephones -->
<div id="add_person_phone_number" class="add_contact_method" style="display:none;">
  <div class="add"><a href="#" onclick="addanotherphone();">{{t "Add another"}}</a></div>
</div class="contact_methods" style="display:none;">
</div></div>
</td>
</tr>
<!-- END: telephone -->
<!-- BEGIN: email -->
<tr>
  <th><h2>{{t "Email"}}</h2></th>
  <td><div class="contact_forms email_addresses" id="email_address_list_person"><div id="blank_slate_person_email_address" class='blank_slate'>{{t "Add an email address"}}</div><div class="contact_methods" style="display:none;">
<!-- BEGIN: emails -->
  <div class="contact_method new_contact_method">
    <input class="autofocus" id="person_contact_data_email_addresses__address" name="person[contact_data][email_addresses][][address]" size="30" type="text" value="{personemailaddress}"/>
    
	<span class="overlay_wrapper">
    <label for="person_contact_data_email_addresses__location" class="overlabel">{{t "Work"}}</label>
    <input id="person_contact_data_email_addresses__location" class="person_contact_input_type" name="person[contact_data][email_addresses][][location]" value="{personemailtype}" style="padding-left:2px;margin-left:4px;" />
	</span class="overlay_wrapper">
    <span class="addremove"><a href="#" class="remove">{{t "Remove"}}</a></span>
  </div>
<!-- END: emails -->
<div id="add_person_email_address" class="add_contact_method" style="display:none;">
  <div class="add"><a href="#">{{t "Add another"}}</a></div>
</div>
</div></div>
<script type="text/javascript"></script>
</td>
</tr>
<!-- END: email -->
<!-- BEGIN: website -->
<tr>
  <th><h2>{{t "Websites"}}</h2></th>
  <td><div class="contact_forms web_addresses" id="web_address_list_person"><div id="blank_slate_person_web_address" class='blank_slate'>{{t "Add a website address"}}</div><div class="contact_methods" style="display:none;">
<!-- BEGIN: websites -->
  <div class="contact_method new_contact_method">
    <input class="autofocus" id="person_contact_data_web_addresses__url" name="person[contact_data][web_addresses][][url]" size="30" type="text" value="{personurladdress}" />
    
	<span class="overlay_wrapper">
    <label for="person_contact_data_web_addresses__location" class="overlabel">{{t "Work"}}</label>
    <input id="person_contact_data_web_addresses__location" class="person_contact_input_type" name="person[contact_data][web_addresses][][location]" value="{personurltype}" style="padding-left:2px;margin-left:4px;" />
	</span class="overlay_wrapper">
    <span class="addremove"><a href="#" class="remove">{{t "Remove"}}</a></span>
  </div>
<!-- END: websites -->
<div id="add_person_web_address" class="add_contact_method" style="display:none;">
  <div class="add"><a href="#">{{t "Add another"}}</a></div>
</div>
</div></div>
<script type="text/javascript"></script>
</td>
</tr>
<!-- END: website -->
<!-- BEGIN: address -->
<tr class="addresses">
  <th><h2>{{t "Address"}}</h2></th>
  <td><div class="contact_forms addresses" id="address_list_person"><div id="blank_slate_person_address" class='blank_slate'>{{t "Add an address"}}</div><div class="contact_methods" style="display:none;">
<!-- BEGIN: addresses -->
<div class="contact_method new_contact_method street">
  <div class="fields">
    <div style="position: relative;">
      <p class="address"><textarea class="autofocus overlayable" id="person_contact_data_addresses_address_x8b40542a0029584e95a78b_street" name="person[contact_data][addresses][][street]" title="Address" value="{personaddressstreet}"></textarea></p>
      <p><input class="city overlayable" id="person_contact_data_addresses_address_x8b40542a0029584e95a78b_city" name="person[contact_data][addresses][][city]" title="City" type="text" value="{personaddresscity}" />
      <input class="state overlayable" id="person_contact_data_addresses_address_x8b40542a0029584e95a78b_state" name="person[contact_data][addresses][][state]" title="State" type="text" value="{personaddressstate}" />
      <input class="zip overlayable" id="person_contact_data_addresses_address_x8b40542a0029584e95a78b_zip" name="person[contact_data][addresses][][zip]" title="Zip" type="text" value="{personaddresszip}" /></p>
      <p>
	<span class="overlay_wrapper">
		<label for="person_contact_data_addresses__country" class="overlabel">{{t "country"}}</label>
		<input class="country" id="person_contact_data_addresses__country" name="person[contact_data][addresses][][country]" value="{personaddresscountry}"/></p>
	</span class="overlay_wrapper">
      <div class="loc_remove">
        
	<span class="overlay_wrapper">
		<label for="person_contact_data_addresses__location" class="overlabel">{{t "Work"}}</label>
		<input id="person_contact_data_addresses__location" name="person[contact_data][addresses][][location]" value="{personaddresstype}"/>
	</span class="overlay_wrapper">
        <span class="addremove"><a href="#" class="remove">{{t "Remove"}}</a></span>
      </div>
    </div>
  </div>
</div>
<script type="text/javascript">
</script>
<!-- END: addresses -->
<div id="add_person_address" class="add_contact_method" style="display:none;">
  <div class="add"><a href="#">{{t "Add another"}}</a></div>
</div>
</div></div>
<script type="text/javascript"></script>
</td>
</tr>
<!-- END: address -->
        
      </table class="contact_types" cellpadding="0" cellspacing="0" id="contact_section">
</div class="secondary_fields">
  
<!-- BEGIN: note -->
<div class="contact_forms background" style="padding:10px;padding-left:30px;">
          <p class="background_label"><strong>{{t "Background info"}}</strong> ({{t "bio, how you met, etc"}})</p>
          <textarea rows="5" name="person[background]" id="person_background" cols="40" value="{personnote}"></textarea>
</div class="contact_forms background">
<!-- END: note -->
<div class="wheretosave" style="padding:10px;padding-left:30px;">
        <h2>{{t "Where to save this contact?"}}</h2>
        <div id="new_person_permissions" class="form_section">
          <div class="select_permissions" behavior="select_permissions" data-permissions-initialized="data-permissions-initialized">
  <div class="scope activated">
    <label><input type="checkbox" value="Everyone" name="person[visible_to]" id="person_visible_to_everyone" checked="checked">{{t " Personal contacts"}}</label>
  </div class="scope ">
  <div class="scope ">
    <label><input type="checkbox" value="Owner" name="person[visible_to]" id="person_visible_to_owner">{{t " Highrise CRM contacts"}}</label>
  </div class="scope ">
  
  
          </div class="select_permissions" behavior="select_permissions" data-permissions-initialized="data-permissions-initialized">
        </div id="new_person_permissions" class="form_section">
</div class="permissions edit_section">
 
    <p class="submit" style="padding:10px;padding-left:30px;">
      <input name="commit" type="submit" value="Add this contact" style="padding:3px;" /><span>{{t "or"}}</span>
      <a onclick="$.fancybox.close();" class="admin" style="color:red;">{{t "Cancel"}}</a>
    </p>
</div class="{vcfsource}contacts">
<!-- END: personcontacts -->
</form action="index.php?module=addcontact" autocomplete="off" class="new subject" id="new_person" method="post">
</div id="addcontactpage" style="width:500px;">
<script type="text/javascript">
$('.addremove a.remove').click(function () {
// get the parent DOM .new_contact_method 
var $iamat = $(this).parents('.new_contact_method');
// get the number of parents that is there
var itemsleft = $iamat.parent().children('.new_contact_method').length; 
if ( itemsleft === 1 ) 
	{
	$iamat.find('input').each(function () 
		{
		$(this).val('');
		})
	}
else
	{
	$iamat.remove();
	}
})
$('.contact_forms').each( function() 
	{
	if ( $(this).find('input:first').val() != "" ) 
		{
		$(this).find('.blank_slate').hide().next().show().find('label').each( function () { if ($(this).next().val() != "" ) $(this).hide(); });
		$(this).find('.add_contact_method').show();
		}
	});
$('.contact_forms').click(function(){
var $us = $(this);
//no close all the other .contact_forms
$('.contact_forms').not(this).each( function() 
	{
	if ( $(this).find('input:first').val() != "" ) return true;
	$(this).find('.blank_slate').show().next().hide();
	});
if ( $(this).find('.blank_slate').is(':visible') ) 
	{// if it's visible
	$(this).find('.blank_slate').hide().next().show().find('input:first').focus();
	$(this).find('.add_contact_method').show();
	}
});
</script>
<script type="text/javascript">
// add the autocomplete and hide the label
var phonetypes = "Work Mobile Home Car Fax Skype Other Pager".split(" ");
$('input.person_contact_input_type').focus(function() {$(this).prev().hide();}).focusout(function() 
	{
	if ( $(this).val() == "" ) $(this).prev().show();
	}).autocomplete(phonetypes, { multiple: true, selectFirst: false});
function addanotherphone() {
//$copy = $('.contact_method')[0].clone();
$('.edit_phone:last').clone().insertAfter('.edit_phone:last');
// reset the input fields
$('.edit_phone:last input').val('');
// add the autocomplete and hide the label and show the label before exiting
$('.edit_phone:last input.person_contact_input_type').focus(function() {$(this).prev().hide();}).focusout(function() 
	{
	if ( $(this).val() == "" ) $(this).prev().show();
	}).autocomplete(phonetypes, { multiple: true, selectFirst: false}).prev().show();
$('.edit_phone:last .addremove a.remove').click(function () 
	{
	// get the parent DOM .new_contact_method 
	var $iamat = $(this).parents('.new_contact_method');
	// get the number of parents that is there
	var itemsleft = $iamat.parent().children('.new_contact_method').length; 
	if ( itemsleft === 1 ) 
		{
		$iamat.find('input').each(function () 
			{
			$(this).val('');
			})
		}
	else
		{
		$iamat.remove();
		}
	})
};
</script>
<script>
// jQuery Form Plugin options
var myFormOptions = {
  target:        '#addcontactpage',
  beforeSubmit:  formBeforeSubmit,
  success:       formAfterSubmit
};
 
function formBeforeSubmit() {
  // PERFORM ACTIONS BEFORE FORM SUBMIT HERE
  return true;
}
 
function formAfterSubmit()  {
  // PERFORM ACTIONS AFTER FORM SUBMIT HERE
}
$('#new_person').ajaxForm(myFormOptions);
</script>
<!-- END: main -->
